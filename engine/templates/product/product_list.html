{% extends 'base.html' %}

{% block title %}Product Management{% endblock %}

{% block content %}
  <button
    onclick="window.location.href='{% url 'product_create' %}'"
    class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition"
  >
    Add New Product
  </button>

  <div class="mt-6 bg-white shadow-md rounded-md overflow-hidden">
    <table class="w-full border-collapse">
      <thead>
        <tr class="bg-gray-200 text-gray-700">
          <th class="py-2 px-4">Name</th>
          <th class="py-2 px-4">Barcode</th>
          <th class="py-2 px-4">Price</th>
          <th class="py-2 px-4">Stock</th>
          <th class="py-2 px-4">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for product in products %}
        <tr class="border-t hover:bg-gray-50">
          <td class="py-2 px-4 text-center">{{ product.name }}</td>
          <td class="py-2 px-4 text-center">{{ product.barcode }}</td>
          <td class="py-2 px-4 text-center">Rp. {{ product.price }}</td>
          <td class="py-2 px-4 text-center">{{ product.stock }}</td>
          <td class="py-2 px-4 text-center flex justify-center gap-4">
            <a
              href="{% url 'product_update' product.id %}"
              class="text-green-600 flex items-center gap-2 hover:text-green-800"
            >
              <i class="ph ph-pencil text-xl"></i> Edit
            </a>

            <a
              href="javascript:void(0);"
              onclick="showDeleteModal('{{ product.id }}', '{{ product.name }}')"
              class="text-red-600 flex items-center gap-2 hover:text-red-800"
            >
              <i class="ph ph-trash text-xl"></i> Delete
            </a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  {% include "product/delete_modal.html" %}
{% endblock %}

{% block scripts %}
  <script>
    function showDeleteModal(productId, productName) {
      document.getElementById("deleteProductName").innerText = productName;
      document
        .getElementById("deleteConfirmButton")
        .setAttribute(
          "href",
          `{% url 'product_delete' 0 %}`.replace("0", productId)
        );
      openModal("deleteModal");
    }
  </script>
{% endblock %}
